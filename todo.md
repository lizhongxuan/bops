# 简化可视化工作流 Todo

目标: 工作流编排页以“步骤列表”为核心，默认无需写 YAML；脚本库与 cmd.run 可通过简单表单完成配置，其它动作放入高级区或高级编辑器。

## M0 方案与对齐
| ID | 任务 | 产出 | 状态 |
| --- | --- | --- | --- |
| M0-1 | 方案更新 | `design.md` 简化可视化编排方案 | 完成 |
| M0-2 | 需求确认 | 基础动作范围、隐藏字段清单 | 待办 |

## M1 页面结构重构
| ID | 任务 | 产出 | 状态 |
| --- | --- | --- | --- |
| M1-1 | 编排页布局 | 顶部全局信息 + 中央步骤列表 + 辅助区 | 待办 |
| M1-2 | 步骤列表组件 | 步骤卡片列表 + 新增按钮 | 待办 |
| M1-3 | 交互操作 | 步骤拖拽排序/复制/删除 | 待办 |
| M1-4 | 折叠高级区 | 每步高级配置折叠区 | 待办 |

## M2 主机与环境变量可视化
| ID | 任务 | 产出 | 状态 |
| --- | --- | --- | --- |
| M2-1 | 主机管理弹窗 | hosts/groups CRUD + 搜索 | 待办 |
| M2-2 | 目标选择器 | 步骤级 host/group 多选 | 待办 |
| M2-3 | env_packages 入口 | 全局环境变量包选择 | 待办 |
| M2-4 | env.set 表单 | 键值对编辑器 | 待办 |

## M3 基础动作表单
| ID | 任务 | 产出 | 状态 |
| --- | --- | --- | --- |
| M3-1 | cmd.run 表单 | cmd/dir/env 基础字段 | 待办 |
| M3-2 | script.shell 表单 | script/脚本库二选一 | 待办 |
| M3-3 | script.python 表单 | script/脚本库二选一 | 待办 |
| M3-4 | 脚本库接入 | 拉取脚本库列表 + 预览 | 待办 |

## M4 高级动作与 YAML
| ID | 任务 | 产出 | 状态 |
| --- | --- | --- | --- |
| M4-1 | 高级动作入口 | template/pkg/service 等动作折叠显示 | 待办 |
| M4-2 | YAML 预览 | 只读 YAML 折叠面板 | 待办 |
| M4-3 | 高级编辑器 | 可编辑 YAML + 同步回 UI | 待办 |
| M4-4 | 非兼容提示 | YAML 包含未知字段时提示高级模式 | 待办 |

## M5 数据映射与校验
| ID | 任务 | 产出 | 状态 |
| --- | --- | --- | --- |
| M5-1 | UI -> YAML 映射 | 表单数据生成 workflow YAML | 待办 |
| M5-2 | YAML -> UI 解析 | YAML 回填步骤列表 | 待办 |
| M5-3 | 校验提示 | 表单级错误高亮与消息 | 待办 |
| M5-4 | 运行状态联动 | 失败步骤回链到步骤卡片 | 待办 |

## M6 测试与验收
| ID | 任务 | 产出 | 状态 |
| --- | --- | --- | --- |
| M6-1 | 映射单元测试 | UI/YAML 转换测试 | 待办 |
| M6-2 | 关键流程验收 | 新建 -> 编排 -> 运行 -> 失败回链 | 待办 |
